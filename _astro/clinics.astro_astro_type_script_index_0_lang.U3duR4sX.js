import{g as u,a as c,f as b,s as h,b as E}from"./profile.BzHqYqaP.js";import"./aes.Ce_Q33qD.js";function p(){const n=c(),t=document.getElementById("display-name");t&&(t.textContent=E(n))}p();document.getElementById("login-btn")?.addEventListener("click",()=>{window.showLoginModal()});window.addEventListener("user-logged-in",()=>p());const a=document.getElementById("clinics-form"),f=document.getElementById("submit-progress"),g=document.getElementById("progress-text");a?.addEventListener("submit",async n=>{n.preventDefault();let t=u(),o=c();if((!t||!o)&&(window.showProfileModal(),await new Promise(e=>{window.addEventListener("profile-created",e,{once:!0})}),t=u(),o=c()),!t||!o){alert("Failed to create profile. Please try again.");return}const r=new FormData(a),s={},d=[];r.getAll("skills").forEach(e=>d.push(e));const m=[];r.getAll("ageGroups").forEach(e=>m.push(e)),r.forEach((e,l)=>{l==="skills"?s.skills=d.join(", "):l==="ageGroups"?s.ageGroups=m.join(", "):e&&(s[l]=e)});const y={profile:o,formType:"Bike Clinic Instructor Volunteer",formData:s,email:s.email},w=b(y);f?.classList.remove("hidden");const i=a.querySelector('button[type="submit"]');i&&(i.disabled=!0),await h(t.secretKey,w,e=>{g&&(g.textContent=e)})?(!localStorage.getItem("has_submitted")?(window.showNsecModal(t.nsec),localStorage.setItem("has_submitted","true")):alert("Volunteer form submitted successfully!"),a.reset()):alert("Failed to submit. Please check your connection and try again."),f?.classList.add("hidden"),i&&(i.disabled=!1)});
