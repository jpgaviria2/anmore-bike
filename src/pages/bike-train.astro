---
/**
 * Bike Train Coordination Page
 * 
 * Enables parents and volunteers to:
 * - Draw safe routes to/from schools
 * - Share route details with safety information
 * - Coordinate bike train schedules
 * - Sign up as route coordinators
 * 
 * Collects comprehensive OSM route data:
 * - Cycleway infrastructure
 * - Crossing types and traffic calming
 * - Surface conditions and hazards
 */

import Layout from '../layouts/Layout.astro';
import Navigation from '../components/Navigation.astro';
import ProfileModal from '../components/ProfileModal.astro';
---

<Layout title="Bike Train to School - Anmore.bike">
  <Navigation />
  <ProfileModal />
  
  <div class="container mx-auto px-4 py-8 md:py-12">
    <!-- Header -->
    <div class="max-w-4xl mx-auto mb-8">
      <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
        Bike Train to School
      </h1>
      <p class="text-lg text-gray-700 mb-4">
        Organize safe group rides to school! A "bike train" is a group of children riding together 
        along a set route, supervised by adult volunteers. Share your route, coordinate schedules, 
        and help kids bike safely to school.
      </p>
      <div class="grid md:grid-cols-2 gap-4">
        <div class="bg-green-50 border-2 border-green-200 rounded-lg p-4">
          <h3 class="font-bold text-green-900 mb-2">üö¥ Benefits of Bike Trains</h3>
          <ul class="text-sm text-green-800 space-y-1">
            <li>‚Ä¢ Safety in numbers</li>
            <li>‚Ä¢ Build cycling confidence</li>
            <li>‚Ä¢ Reduce car traffic at schools</li>
            <li>‚Ä¢ Social & environmental benefits</li>
          </ul>
        </div>
        <div class="bg-blue-50 border-2 border-blue-200 rounded-lg p-4">
          <h3 class="font-bold text-blue-900 mb-2">üìç Route Planning Tips</h3>
          <ul class="text-sm text-blue-800 space-y-1">
            <li>‚Ä¢ Use quiet residential streets</li>
            <li>‚Ä¢ Look for bike lanes or wide shoulders</li>
            <li>‚Ä¢ Minimize busy intersection crossings</li>
            <li>‚Ä¢ Choose well-lit, visible routes</li>
          </ul>
        </div>
      </div>
    
      <!-- WhatsApp Community Banner -->
      <div class="mt-6 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-300 rounded-lg p-5 flex flex-col sm:flex-row items-center gap-4">
        <div class="flex-shrink-0">
          <svg width="40" height="40" fill="#25D366" viewBox="0 0 24 24">
            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.890-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
          </svg>
        </div>
        <div class="flex-1 text-center sm:text-left">
          <h3 class="font-bold text-green-900 text-lg">Join the Bike Train Community</h3>
          <p class="text-sm text-green-800 mt-1">Coordinate rides, get updates, and connect with other families on WhatsApp.</p>
        </div>
        <a 
          href="https://chat.whatsapp.com/IxJbNsZCtmi8uhojxH4KiN" 
          target="_blank" 
          rel="noopener noreferrer"
          class="inline-flex items-center gap-2 px-6 py-3 bg-green-500 hover:bg-green-600 text-white font-bold rounded-lg transition shadow-md whitespace-nowrap"
        >
          <svg width="20" height="20" fill="white" viewBox="0 0 24 24">
            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.890-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
          </svg>
          Join WhatsApp Group
        </a>
      </div>
    </div>
    
    <!-- Map Section -->
    <div class="max-w-6xl mx-auto mb-8">
      <div class="bg-white rounded-xl shadow-lg overflow-hidden">
        <div class="bg-green-600 text-white p-4">
          <h2 class="text-xl font-bold">Sunnyside to School Route</h2>
          <p class="text-sm text-green-100 mt-1">
            View the approved bike train route. Use the WhatsApp button to suggest new routes.
          </p>
        </div>
        <div id="map" class="h-[500px] md:h-[600px]"></div>
      </div>
    </div>
    
    <!-- Route Details Section -->
    <div class="max-w-4xl mx-auto space-y-6">
      
      <!-- Route Info Card -->
      <div class="bg-white rounded-xl shadow-lg p-6 md:p-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">üö¥ Sunnyside to School ‚Äî Route Details</h2>
        
        <div class="grid md:grid-cols-2 gap-6 mb-8">
          <div class="space-y-4">
            <div class="flex items-start gap-3">
              <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                <span class="text-green-700 font-bold text-sm">üïó</span>
              </div>
              <div>
                <p class="font-semibold text-gray-900">Departure Time</p>
                <p class="text-gray-700 text-lg">8:30 AM from the start of the route</p>
              </div>
            </div>
            
            <div class="flex items-start gap-3">
              <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                <span class="text-green-700 font-bold text-sm">üìç</span>
              </div>
              <div>
                <p class="font-semibold text-gray-900">Start Point</p>
                <p class="text-gray-700">Countryside area, Sunnyside Rd</p>
              </div>
            </div>
            
            <div class="flex items-start gap-3">
              <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                <span class="text-green-700 font-bold text-sm">üè´</span>
              </div>
              <div>
                <p class="font-semibold text-gray-900">End Point</p>
                <p class="text-gray-700">School</p>
              </div>
            </div>
          </div>
          
          <div class="space-y-4">
            <div class="flex items-start gap-3">
              <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                <span class="text-green-700 font-bold text-sm">‚≠ê</span>
              </div>
              <div>
                <p class="font-semibold text-gray-900">Difficulty</p>
                <p class="text-gray-700">Easy ‚Äî flat, quiet streets</p>
              </div>
            </div>
            
            <div class="flex items-start gap-3">
              <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                <span class="text-green-700 font-bold text-sm">üìÖ</span>
              </div>
              <div>
                <p class="font-semibold text-gray-900">Schedule</p>
                <p class="text-gray-700">School days (Mon‚ÄìFri)</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Volunteers Section -->
      <div class="bg-white rounded-xl shadow-lg p-6 md:p-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-4">üôã Parent Volunteers</h2>
        
        <div class="space-y-4">
          <div class="bg-amber-50 border-2 border-amber-200 rounded-lg p-5">
            <h3 class="font-bold text-amber-900 text-lg mb-3">How it works</h3>
            <ul class="space-y-3 text-amber-900">
              <li class="flex items-start gap-2">
                <span class="font-bold text-lg leading-6">‚Ä¢</span>
                <span>Parent volunteers ride <strong>at the front and back</strong> of the group to keep kids safe</span>
              </li>
              <li class="flex items-start gap-2">
                <span class="font-bold text-lg leading-6">‚Ä¢</span>
                <span><strong>The more volunteers, the better!</strong> More adults = safer ride for everyone</span>
              </li>
              <li class="flex items-start gap-2">
                <span class="font-bold text-lg leading-6">‚Ä¢</span>
                <span>Volunteers are <strong>not responsible</strong> for supervising individual youth</span>
              </li>
              <li class="flex items-start gap-2">
                <span class="font-bold text-lg leading-6">‚Ä¢</span>
                <span>If your child needs direct support, <strong>parents must join the ride group themselves</strong></span>
              </li>
            </ul>
          </div>
          
          <div class="bg-green-50 border-2 border-green-200 rounded-lg p-5">
            <h3 class="font-bold text-green-900 text-lg mb-2">Want to volunteer?</h3>
            <p class="text-green-800 mb-4">
              Join the WhatsApp community to sign up as a volunteer, coordinate rides, and stay updated on schedule changes.
            </p>
            <a 
              href="https://chat.whatsapp.com/IxJbNsZCtmi8uhojxH4KiN" 
              target="_blank" 
              rel="noopener noreferrer"
              class="inline-flex items-center gap-2 px-6 py-3 bg-green-500 hover:bg-green-600 text-white font-bold rounded-lg transition shadow-md"
            >
              <svg width="20" height="20" fill="white" viewBox="0 0 24 24">
                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.890-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
              </svg>
              Join the Bike Train Community
            </a>
          </div>
        </div>
      </div>
      
    </div>
  </div>
  
  <!-- Load Leaflet and scripts -->
  <script is:inline src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script is:inline src="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.js"></script>
  <script is:inline src="/anmore-bike/map-routes.js"></script>
  
  <script is:inline>
    const ANMORE_CENTER = { lat: 49.318, lng: -122.858 };
    const DEFAULT_ZOOM = 15;
    
    window.addEventListener('load', () => {
      if (typeof L === 'undefined') return;
      
      const map = L.map('map').setView([ANMORE_CENTER.lat, ANMORE_CENTER.lng], DEFAULT_ZOOM);
      
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
        maxZoom: 19
      }).addTo(map);
      
      // Initialize route system with drawing + WhatsApp submit
      if (typeof window.initAnmoreRoutes === 'function') {
        window.initAnmoreRoutes(map, {
          enableDrawing: true,
          enableSubmission: true,
          category: 'bike-train',
          defaultCategory: 'bike-train'
        });
      }
    });
  </script>
</Layout>
