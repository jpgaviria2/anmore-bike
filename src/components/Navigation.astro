---
// Mobile-first navigation component
import { getRelativeLocaleUrl } from 'astro:i18n';

const currentPath = Astro.url.pathname;
const base = import.meta.env.BASE_URL;

const navItems = [
  { href: `${base}`, label: 'Home' },
  { href: `${base}trail-building`, label: 'Trail Building' },
  { href: `${base}pump-track`, label: 'Pump Track' },
  { href: `${base}bike-train`, label: 'Bike Train' },
  { href: `${base}clinics`, label: 'Bike Clinics' },
  { href: `${base}afterschool`, label: 'Afterschool Programs' },
  { href: `${base}leaderboard`, label: 'Leaderboard' },
  { href: `${base}admin`, label: 'ðŸ”’ Admin', admin: true }
];
---

<nav class="bg-green-600 text-white sticky top-0 z-40 shadow-lg">
  <div class="container mx-auto px-4">
    <div class="flex items-center justify-between py-4">
      <!-- Logo/Brand -->
      <a href={base} class="text-xl md:text-2xl font-bold flex items-center gap-2">
        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
        </svg>
        <span class="hidden sm:inline">Anmore.bike</span>
      </a>
      
      <!-- Desktop Navigation -->
      <div class="hidden lg:flex items-center gap-6">
        {navItems.map(item => (
          <a 
            href={item.href}
            class={`hover:text-green-200 transition ${currentPath === item.href ? 'font-bold border-b-2 border-white' : ''}`}
          >
            {item.label}
          </a>
        ))}
      </div>
      
      <!-- Mobile Menu Button -->
      <button 
        id="mobile-menu-btn"
        class="lg:hidden p-2 rounded-lg hover:bg-green-700 transition"
        aria-label="Toggle menu"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path id="menu-icon" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          <path id="close-icon" class="hidden" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
    
    <!-- Mobile Menu -->
    <div id="mobile-menu" class="hidden lg:hidden pb-4 max-h-[calc(100vh-5rem)] overflow-y-auto">
      {navItems.map(item => (
        <a 
          href={item.href}
          class={`block py-3 px-4 hover:bg-green-700 rounded transition ${currentPath === item.href ? 'bg-green-700 font-bold' : ''}`}
        >
          {item.label}
        </a>
      ))}
    </div>
  </div>
</nav>

<script>
  const menuBtn = document.getElementById('mobile-menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');
  const menuIcon = document.getElementById('menu-icon');
  const closeIcon = document.getElementById('close-icon');
  
  menuBtn?.addEventListener('click', () => {
    const isHidden = mobileMenu?.classList.contains('hidden');
    
    if (isHidden) {
      mobileMenu?.classList.remove('hidden');
      menuIcon?.classList.add('hidden');
      closeIcon?.classList.remove('hidden');
    } else {
      mobileMenu?.classList.add('hidden');
      menuIcon?.classList.remove('hidden');
      closeIcon?.classList.add('hidden');
    }
  });
</script>
